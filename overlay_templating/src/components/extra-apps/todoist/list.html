<div class="fel__todoist">
  <div class="fel__todoist__sidebar mr-4">
    <div class="position-relative mb-4">
      <i class="fel__todoist__searchIcon fe fe-search"></i>
      <input class="fel__todoist__searchInput" type="text" placeholder="Search task..." />
    </div>
    <div class="fel__customScroll fel__todoist__categories d-flex flex-column">
      <div
        class="fel__todoist__category fel__todoist__category--title text-dark font-size-18 font-weight-bold"
      >
        <span class="text-truncate">Overall</span>
      </div>
      <a href="javascript: void(0);" class="fel__todoist__category text-dark font-size-18">
        <span class="text-truncate">Today</span>
      </a>
      <a href="javascript: void(0);" class="fel__todoist__category text-dark font-size-18">
        <span class="text-truncate">Next 7 days</span>
      </a>
      <div
        class="fel__todoist__category fel__todoist__category--title text-dark font-size-18 font-weight-bold"
      >
        <span class="text-truncate">To Do Lists</span>
      </div>
      <a
        href="javascript: void(0);"
        class="fel__todoist__category fel__todoist__category--current text-dark font-size-18"
      >
        <span class="text-truncate">Welcome &#128075;</span>
      </a>
      <a href="javascript: void(0);" class="fel__todoist__category text-dark font-size-18">
        <span class="text-truncate">Homework</span>
        <span>(1)</span>
      </a>
      <a href="javascript: void(0);" class="fel__todoist__category text-dark font-size-18">
        <span class="text-truncate">Fitness</span>
      </a>
    </div>
  </div>
  <div class="flex-grow-1">
    <div class="card">
      <div class="card-header card-header-flex flex-wrap">
        <div class="d-flex flex-column justify-content-center mr-auto">
          <h5 class="mb-0 mr-2 font-size-18 font-weight-bold">Welcome &#128075;</h5>
        </div>
        <div class="d-flex flex-column justify-content-center">
          <div>
            <a
              href="javascript: void(0);"
              class="btn btn-sm btn-light mr-2"
              data-toggle="tooltip"
              data-placement="top"
              title=""
              data-original-title="Unlock Account"
            >
              <i class="fe fe-unlock"></i>
            </a>
            <a
              href="javascript: void(0);"
              class="btn btn-sm btn-light mr-2"
              data-toggle="tooltip"
              data-placement="top"
              title=""
              data-original-title="Mark as important"
            >
              <i class="fe fe-star"></i>
            </a>
            <a
              href="javascript: void(0);"
              class="btn btn-sm btn-light"
              data-toggle="tooltip"
              data-placement="top"
              title=""
              data-original-title="Delete user"
            >
              <i class="fe fe-trash"></i>
            </a>
          </div>
        </div>
      </div>
      <div class="card-body">
        <h6 class="text-uppercase text-dark font-size-18 font-weight-bold mb-2">Current tasks</h6>
        <p class="mb-3">Welocme to Todoist! Let's get you started with a few tips</p>
        <div class="fel__todoist__list dd mb-4">
          <ol class="dd-list">
            <li class="dd-item dd3-item" data-id="13">
              <div class="dd-handle dd3-handle"></div>
              <div class="dd3-content">
                <label class="fel__utils__control fel__utils__control__checkbox">
                  <input type="checkbox" />
                  <span class="fel__utils__control__indicator align-text-top"></span>
                  Level 1
                </label>
              </div>
            </li>
            <li class="dd-item dd3-item" data-id="14">
              <div class="dd-handle dd3-handle"></div>
              <div class="dd3-content">
                <label class="fel__utils__control fel__utils__control__checkbox">
                  <input type="checkbox" />
                  <span class="fel__utils__control__indicator align-text-top"></span>
                  Level 1
                </label>
              </div>
            </li>
            <li class="dd-item dd3-item" data-id="15">
              <div class="dd-handle dd3-handle"></div>
              <div class="dd3-content">
                Level 1:
              </div>
              <ol class="dd-list">
                <li class="dd-item dd3-item" data-id="16">
                  <div class="dd-handle dd3-handle"></div>
                  <div class="dd3-content">
                    <label class="fel__utils__control fel__utils__control__checkbox">
                      <input type="checkbox" />
                      <span class="fel__utils__control__indicator align-text-top"></span>
                      Level 2
                    </label>
                  </div>
                </li>
                <li class="dd-item dd3-item" data-id="17">
                  <div class="dd-handle dd3-handle"></div>
                  <div class="dd3-content">
                    <label class="fel__utils__control fel__utils__control__checkbox">
                      <input type="checkbox" />
                      <span class="fel__utils__control__indicator align-text-top"></span>
                      Level 2
                    </label>
                  </div>
                </li>
                <li class="dd-item dd3-item" data-id="18">
                  <div class="dd-handle dd3-handle"></div>
                  <div class="dd3-content">
                    <label class="fel__utils__control fel__utils__control__checkbox">
                      <input type="checkbox" />
                      <span class="fel__utils__control__indicator align-text-top"></span>
                      Level 2
                    </label>
                  </div>
                </li>
              </ol>
            </li>
          </ol>
        </div>
        <a href="#" class="text-gray-6 fel__todoist__addTask"
          ><i class="fe fe-plus-circle mr-2"></i> Add Task</a
        >
        <input
          class="fel__todoist__inputTask form-control mt-2 d-none"
          placeholder="Add task here and press enter..."
          type="text"
        />
        <h6 class="text-uppercase text-dark font-size-18 font-weight-bold mb-2 mt-4">Completed</h6>
        <p class="mb-3">Welocme to Todoist! Let's get you started with a few tips</p>
        <div class="fel__todoist__completedList dd mb-2">
          <ol class="dd-list">
            <li class="dd-item dd3-item" data-id="13">
              <div class="dd-handle dd3-handle"></div>
              <div class="dd3-content">
                <label class="fel__utils__control fel__utils__control__checkbox">
                  <input type="checkbox" checked />
                  <span class="fel__utils__control__indicator align-text-top"></span>
                  Level 1
                </label>
              </div>
            </li>
            <li class="dd-item dd3-item" data-id="14">
              <div class="dd-handle dd3-handle"></div>
              <div class="dd3-content">
                <label class="fel__utils__control fel__utils__control__checkbox">
                  <input type="checkbox" checked />
                  <span class="fel__utils__control__indicator align-text-top"></span>
                  Level 1
                </label>
              </div>
            </li>
            <li class="dd-item dd3-item" data-id="14">
              <div class="dd-handle dd3-handle"></div>
              <div class="dd3-content">
                <label class="fel__utils__control fel__utils__control__checkbox">
                  <input type="checkbox" checked />
                  <span class="fel__utils__control__indicator align-text-top"></span>
                  Level 1
                </label>
              </div>
            </li>
          </ol>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-lg-4">
        <div class="card">
          <div class="card-body">
            //= ../../widgets/chart/4.html
          </div>
        </div>
      </div>
      <div class="col-lg-4">
        <div class="card">
          <div class="card-body">
            //= ../../widgets/chart/4-1.html
          </div>
        </div>
      </div>
      <div class="col-lg-4">
        <div class="card">
          <div class="card-body">
            //= ../../widgets/chart/4-2.html
          </div>
        </div>
      </div>
    </div>
    <div class="card">
      <div class="card-body">
        //= ../../widgets/table/6.html
      </div>
    </div>
  </div>
</div>

<script>
  /////////////////////////////////////////////////////////////////////////////////////////
  // "TODOIST" module scripts

  ;(function($) {
    'use strict'
    $(function() {
      /////////////////////////////////////////////////////////////////////////////////////////
      $(document).ready(function() {
        $('.fel__todoist__list, fel__todoist__completedList').nestable()

        const taskList = $('.fel__todoist__list > .dd-list')
        const addBtn = $('.fel__todoist__addTask')
        const taskInput = $('.fel__todoist__inputTask')

        addBtn.on('click', function(e) {
          e.preventDefault()
          toggleInput()
          if (!taskInput.hasClass('d-none')) {
            taskInput.focus()
          }
          taskInput.on('keypress', function(e) {
            const task = e.target.value
            let taskId = 0

            $('.dd3-item').each(function() {
              const value = parseFloat($(this).attr('data-id'))
              taskId = value > taskId ? value : taskId
              taskId += 1
            })

            if (e.which === 13 && task !== '') {
              const taskMarkup = getTaskMarkup(task, taskId)
              console.log('taskMarkup', taskMarkup)
              taskList.append(taskMarkup)
              taskInput.val('')
            }
          })
        })

        function toggleInput() {
          taskInput.val('').toggleClass('d-none')
        }

        function getTaskMarkup(task, taskId) {
          const markup = $(
            '<li class="dd-item dd3-item" data-id="' +
              taskId +
              '"><div class="dd-handle dd3-handle"></div><div class="dd3-content"><label class="fel__utils__control fel__utils__control__checkbox"><input type="checkbox"/><span class="fel__utils__control__indicator align-text-top"></span>' +
              task +
              '</label></div></li>',
          )
          return markup
        }

        $(document).on('keyup', function(evt) {
          if (evt.keyCode == 27 && !taskInput.hasClass('d-none')) {
            toggleInput()
          }
        })
      })
      /////////////////////////////////////////////////////////////////////////////////////////
    })
  })(jQuery)
</script>
